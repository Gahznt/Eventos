{% macro interval(start, end) %}
    {% set date = start|format_datetime(pattern="yyyyMMd") %}
    {% set date2 = end|format_datetime(pattern="yyyyMMd") %}

    {% if date == date2 %}
        {{ start|format_datetime('medium', 'none') }}
    {% else %}
        {% set d = start|format_datetime(pattern="d") %}
        {% set d2 = end|format_datetime(pattern="d") %}

        {% set m = start|format_datetime(pattern="MM") %}
        {% set m2 = end|format_datetime(pattern="MM") %}

        {% set y = start|format_datetime(pattern="yyyy") %}
        {% set y2 = end|format_datetime(pattern="yyyy") %}

        {% if y == y2 %}
            {% if m == m2 %}
                {% if app.request.getLocale() == 'en' %}
                    {{ start|format_datetime(pattern="MMM d") }} - {{ end|format_datetime(pattern="d, yyyy") }}
                {% else %}
                    {{ start|format_datetime(pattern="d") }} - {{ end|format_datetime('medium', 'none') }}
                {% endif %}
            {% else %}
                {% if app.request.getLocale() == 'en' %}
                    {{ start|format_datetime(pattern="MM/d") }}
                {% else %}
                    {{ start|format_datetime(pattern="d/MM") }}
                {% endif %}
                - {{ end|format_datetime('short', 'none') }}
            {% endif %}
        {% else %}
            {{ start|format_datetime('short', 'none') }} - {{ end|format_datetime('short', 'none') }}
        {% endif %}
    {% endif %}
{% endmacro %}

{% macro replaces(text, certificate) %}
    {% set text = text|replace({'%user_name%': certificate.user.name}) %}
    {% set text = text|replace({'%user_identifier%': certificate.user.identifier}) %}
    {% set text = text|replace({'%edition_name%': certificate.edition.name}) %}
    {% set text = text|replace({'%edition_longname%': certificate.edition.longname}) %}
    {% set text = text|replace({'%edition_place%': certificate.edition.place}) %}
    {% set text = text|replace({'%edition_workload%': certificate.edition.workload}) %}
    {% set text = text|replace({'%edition_voluntaryWorkload%': certificate.edition.voluntaryWorkload}) %}
    {% set text = text|replace({'%edition_date%': _self.interval(certificate.edition.dateStart, certificate.edition.dateEnd)}) %}

    {{ text }}
{% endmacro %}

{% import _self as dateMacro %}

{% set type = 'pdf' %}

{% block stylesheets %}
    {% include "@Base/certificate/templates/certificate.styles.twig" %}
{% endblock %}

{% block body %}


    <div class="{% if type == 'html' %} back-desktop {% else %} back {% endif %}">

        {% if certificate.variables.title is not empty %}
            <div class="{% if type == 'html' %} title-desktop {% else %} title-manual {% endif %}">{{ _self.replaces(certificate.variables.title, certificate) }}</div>
        {% endif %}

        {% if certificate.variables.description is not empty %}
            {% if certificate.variables.title is not empty %}
                <div class="{% if type == 'html' %} text-desktop {% else %} text {% endif %}">
                    {{ _self.replaces(certificate.variables.description, certificate)|nl2br }}
                </div>
            {% else %}
                <div class="{% if type == 'html' %} text-title-desktop {% else %} text-title {% endif %}">
                    {{ _self.replaces(certificate.variables.description, certificate)|nl2br }}
                </div>
            {% endif %}
        {% endif %}

        {#        <div class="{% if type == 'html' %} text-desktop {% else %} text {% endif %}">{{ activity_title }}</div>#}

        {% if certificate.variables.content is not empty %}
            {% if certificate.variables.title is not empty %}
                <div class="{% if type == 'html' %} text-desktop {% else %} text {% endif %}">
                    {{ _self.replaces(certificate.variables.content, certificate)|nl2br }}
                </div>
            {% else %}
                <div class="{% if type == 'html' %} text-title-desktop {% else %} text-title {% endif %}">
                    {{ _self.replaces(certificate.variables.content, certificate)|nl2br }}
                </div>
            {% endif %}
        {% endif %}

        {#        <div class="{% if type == 'html' %} footer-desktop {% else %} footer {% endif %}">#}
        {#            {{ certificate.edition.place }}, {{ dateMacro.interval(certificate.edition.dateStart, certificate.edition.dateEnd) }}#}
        {#        </div>#}

        {% if qrCode != '' %}

            <div class="qr-code"></div>

        {% endif %}

    </div>

{% endblock %}
